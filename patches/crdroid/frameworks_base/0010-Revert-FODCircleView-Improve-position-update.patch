From 09d7eacc0b46561849fe94c87d99826dd6000f76 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Wed, 29 Jul 2020 06:34:30 +0300
Subject: [PATCH 010/116] Revert "FODCircleView: Improve position update"

This reverts commit 39943391379aa657272720d133a5266481fc154d.
---
 .../com/android/systemui/biometrics/FODAnimation.java  |  4 ++--
 .../com/android/systemui/biometrics/FODCircleView.java | 10 ++--------
 2 files changed, 4 insertions(+), 10 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
index 43a08c447df..ce89dc6ff61 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODAnimation.java
@@ -81,8 +81,8 @@ public class FODAnimation extends ImageView {
         recognizingAnim = (AnimationDrawable) getBackground();
     }
 
-    public void updateParams(int positionY) {
-        mAnimParams.y = positionY - (mAnimationSize / 2) + mAnimationOffset;
+    public void updateParams(int mDreamingOffsetY) {
+        mAnimParams.y = mDreamingOffsetY - (mAnimationSize / 2) + mAnimationOffset;
     }
 
     public void setAnimationKeyguard(boolean state) {
diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
index 376b0d50c14..4daaa8a21cd 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
@@ -31,7 +31,6 @@ import android.graphics.Color;
 import android.graphics.Paint;
 import android.graphics.PixelFormat;
 import android.graphics.Point;
-import android.hardware.biometrics.BiometricSourceType;
 import android.graphics.drawable.AnimationDrawable;
 import android.graphics.drawable.BitmapDrawable;
 import android.graphics.drawable.Drawable;
@@ -136,7 +135,6 @@ public class FODCircleView extends ImageView implements ConfigurationListener {
                 mBurnInProtectionTimer.schedule(new BurnInProtectionTask(), 0, 60 * 1000);
             } else if (mBurnInProtectionTimer != null) {
                 mBurnInProtectionTimer.cancel();
-                updatePosition();
             }
         }
 
@@ -433,7 +431,6 @@ public class FODCircleView extends ImageView implements ConfigurationListener {
         dispatchPress();
 
         setFODPressedState();
-        updatePosition();
         invalidate();
     }
 
@@ -571,12 +568,9 @@ public class FODCircleView extends ImageView implements ConfigurationListener {
             mParams.y = mPositionY - cutoutMaskedExtra;
         }
 
-        if (mFODAnimation != null) {
-            mFODAnimation.updateParams(mParams.y);
-        }
-
-        if (mIsDreaming && !mIsCircleShowing) {
+        if (mIsDreaming) {
             mParams.y += mDreamingOffsetY;
+            mFODAnimation.updateParams(mParams.y);
         }
 
         mWindowManager.updateViewLayout(this, mParams);
-- 
2.17.1

